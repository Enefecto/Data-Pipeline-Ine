services:
  # PIPELINE ORCHESTRATOR - Ejecuta los 7 pasos del pipeline completo
  pipeline-orchestrator:
    build: .
    container_name: ine-pipeline-orchestrator
    command: python pipeline_orchestrator.py
    volumes:
      - ./outputs:/app/outputs
      - ./dictionary:/app/dictionary
      - ./steps:/app/steps
      - ./utils:/app/utils
      - ./config.py:/app/config.py
      - ./pipeline_orchestrator.py:/app/pipeline_orchestrator.py
      - ./.env:/app/.env
    env_file:
      - .env
    environment:
      - PYTHONUNBUFFERED=1
      # Configuración de concurrencia
      - MAX_CONCURRENT_BROWSERS=4
      - DOWNLOAD_TIMEOUT=60
      - DELAY_BETWEEN_DOWNLOADS=1.0
      # Configuración de archivos
      - CATALOG_PATH=/app/dictionary/ine_catalog.json
      - OUTPUT_DIR=/app/outputs
      - SAVE_LOCAL_FILES=true
      # Configuración del navegador
      - HEADLESS=true
      # Configuración de ejecución
      # - MAX_DATASETS=5  # Descomentar para testing
